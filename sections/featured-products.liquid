{% comment %}
  Featured Products section inspired by Typhur's product showcase
  Features: Product grid, hover effects, and compelling product information
{% endcomment %}

<div class="py-20 bg-base-100">
  <div class="container mx-auto px-6">
    <div class="text-center mb-16">
      <h2 class="text-4xl lg:text-5xl font-bold mb-6">
        {{ section.settings.heading | default: 'Featured Products' }}
      </h2>
      <p class="text-xl text-base-content/70 max-w-2xl mx-auto">
        {{
          section.settings.subheading
          | default: 'Discover our most popular and innovative products that are revolutionizing the way you cook.'
        }}
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for product in collections[section.settings.collection].products limit: section.settings.products_to_show %}
        <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-all duration-300 group">
          <figure class="relative overflow-hidden">
            {% if product.featured_image %}
              <img
                src="{{ product.featured_image | image_url: width: 400 }}"
                alt="{{ product.featured_image.alt | default: product.title }}"
                class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
                width="400"
                height="256"
              >
            {% endif %}

            {% if product.compare_at_price > product.price %}
              <div class="indicator indicator-start indicator-top">
                <span class="indicator-item badge badge-error">
                  {{
                    product.compare_at_price
                    | minus: product.price
                    | times: 100
                    | divided_by: product.compare_at_price
                    | round
                  -}}
                  % OFF
                </span>
              </div>
            {% endif %}

            <div class="indicator indicator-end indicator-top opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <span class="indicator-item">
                <button class="btn btn-circle btn-primary btn-sm">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                  </svg>
                </button>
              </span>
            </div>
          </figure>

          <div class="card-body">
            <h3 class="card-title text-lg">{{ product.title }}</h3>

            {% if product.description != blank %}
              <p class="text-sm text-base-content/70 line-clamp-2">
                {{ product.description | strip_html | truncatewords: 15 }}
              </p>
            {% endif %}

            <div class="flex items-center justify-between mt-4">
              <div class="flex items-center gap-2">
                {% if product.compare_at_price > product.price %}
                  <span class="text-lg font-bold text-primary">{{ product.price | money }}</span>
                  <span class="text-sm text-base-content/50 line-through">{{ product.compare_at_price | money }}</span>
                {% else %}
                  <span class="text-lg font-bold text-primary">{{ product.price | money }}</span>
                {% endif %}
              </div>

              {% unless product.available %}
                <span class="badge badge-error">Sold Out</span>
              {% endunless %}
            </div>

            <div class="card-actions justify-end mt-4">
              <button href="{{ product.url }}" class="btn btn-primary btn-sm">View Details</button>
            </div>
          </div>
        </div>
      {% else %}
        {% for i in (1..6) %}
          <div class="card bg-base-100 shadow-xl">
            <figure class="bg-base-200 h-64 animate-pulse"></figure>
            <div class="card-body">
              <div class="h-4 bg-base-200 rounded animate-pulse mb-2"></div>
              <div class="h-3 bg-base-200 rounded animate-pulse mb-4"></div>
              <div class="h-6 bg-base-200 rounded animate-pulse"></div>
            </div>
          </div>
        {% endfor %}
      {% endfor %}
    </div>

    {% if section.settings.show_view_all %}
      <div class="text-center mt-12">
        <a
          href="{{ collections[section.settings.collection].url | default: '/collections/all' }}"
          class="btn btn-outline btn-lg"
        >
          View All Products
        </a>
      </div>
    {% endif %}
  </div>
</div>

{% stylesheet %}
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Featured Products",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Discover our most popular and innovative products that are revolutionizing the way you cook."
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Number of products to show",
      "min": 3,
      "max": 12,
      "step": 3,
      "default": 6
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' button",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Featured Products"
    }
  ]
}
{% endschema %}
